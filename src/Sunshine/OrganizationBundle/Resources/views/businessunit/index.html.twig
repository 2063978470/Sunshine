{% extends "@SunshineOrganization/businessunit/businessUnit.html.twig" %}

{% block main_content %}
    <div class="row">
        <div class="col-md-12">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <div class="btn-group btn-group-sm">
                        <button type="button" class="btn btn-default" id="append"><span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span>新建</button>
                        <button type="button" class="btn btn-default"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span>修改</button>
                        <button type="button" class="btn btn-default"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span>删除</button>

                        <div class="btn-group btn-group-sm" role="group">
                            <select class="form-control input-sm" id="company-name">
                                {% for com in company %}
                                    <option>{{ com.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                </div>
                <div class="box-body pad table-responsive">
                    <div class="easyui-layout" style="width:90%;min-height:500px">
                        <div data-options="region:'west',split:true" title="组织架构" style="width:25%;">
                            <ul id="bu" class="easyui-tree" data-options="url:'{{ path('admin_org_bu_tree_json', {'name': defaultCompany}) }}',method:'get',animate:true,lines:true"></ul>
                        </div>
                        <div data-options="region:'center',title:'部门明细'">
                            <div class="bu_content">
                                {{ businessUnits ? "修改或添加部门" : "请添加部门" }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascript %}
    {{ parent() }}
    <script>
        $(document).ready(function () {
            $('#append').click(function () {
                append();
                $("div:contains('部门')").trigger('click');
                $.pjax({url: "{{ path('admin_org_bu_new') }}", container: '.bu_content'});
            });
        })

        function append() {
            var tree = $('#bu');
            var node = tree.tree('getSelected');
            tree.tree('append', {
                parent: (node?node.target:null),
                data: [{
                   text: '部门'
                }]
            });
        }
    </script>
{% endblock %}
